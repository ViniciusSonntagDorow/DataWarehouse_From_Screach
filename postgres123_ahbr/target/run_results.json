{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.4", "generated_at": "2024-07-28T11:04:56.916698Z", "invocation_id": "61907faa-1a5e-4ff8-8e34-acda3fd1662f", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-28T11:04:49.268354Z", "completed_at": "2024-07-28T11:04:49.273348Z"}, {"name": "execute", "started_at": "2024-07-28T11:04:49.274349Z", "completed_at": "2024-07-28T11:04:51.476414Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.2100651264190674, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.postgres123_ahbr.stg_commodities", "compiled": true, "compiled_code": "-- source import\n\nwith source as (\n    SELECT\n        \"Date\",\n        \"Close\",\n        \"Symbol\"\n    FROM\n        \"postgres123_ahbr\".\"public\".\"commodities\"\n),\n\n-- renames/type changes/casts\n\nrenamed as (\n    SELECT\n        CAST(\"Date\" as date) as date,\n        \"Close\" as closing_data,\n        \"Symbol\" as symbol\n    FROM\n        source\n)\n\n-- select * from\n\nSELECT *\nFROM renamed", "relation_name": "\"postgres123_ahbr\".\"public\".\"stg_commodities\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-28T11:04:51.481414Z", "completed_at": "2024-07-28T11:04:51.484416Z"}, {"name": "execute", "started_at": "2024-07-28T11:04:51.484416Z", "completed_at": "2024-07-28T11:04:52.776502Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.296069860458374, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.postgres123_ahbr.stg_movimentacao_commodities", "compiled": true, "compiled_code": "-- source import\n\nwith source as (\n    SELECT\n        date,\n        symbol,\n        action,\n        quantity\n    FROM\n        \"postgres123_ahbr\".\"public\".\"movimentacao_commodities\"\n),\n\n-- renames/type changes/casts\n\nrenamed as (\n    SELECT\n        CAST(date as date) as movement_date,\n        symbol,\n        action,\n        quantity\n    FROM\n        source\n)\n\n-- select * from\n\nSELECT *\nFROM renamed", "relation_name": "\"postgres123_ahbr\".\"public\".\"stg_movimentacao_commodities\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-28T11:04:52.783479Z", "completed_at": "2024-07-28T11:04:52.785495Z"}, {"name": "execute", "started_at": "2024-07-28T11:04:52.785495Z", "completed_at": "2024-07-28T11:04:55.034102Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.2536063194274902, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.postgres123_ahbr.dm_commodities", "compiled": true, "compiled_code": "with commodities as (\n    SELECT\n        date,\n        closing_data,\n        symbol\n    FROM\n        \"postgres123_ahbr\".\"public\".\"stg_commodities\"\n),\n\nmovimentacao as (\n    SELECT\n        movement_date,\n        symbol,\n        action,\n        quantity\n    FROM\n        \"postgres123_ahbr\".\"public\".\"stg_movimentacao_commodities\"\n),\n\njoined as (\n    SELECT\n        c.date,\n        c.symbol,\n        c.closing_data,\n        m.action,\n        m.quantity,\n        (m.quantity * c.closing_data) as value,\n        CASE\n            WHEN m.action = 'sell' then (m.quantity * c.closing_data)\n            ELSE -(m.quantity * c.closing_data)\n        END as profit\n    FROM\n        commodities c\n    INNER JOIN\n        movimentacao m\n    ON\n        c.date = m.movement_date\n        AND\n        c.symbol = m.symbol\n),\n\nlast_day as (\n    SELECT max(date) as max_date\n    FROM joined\n),\n\nfiltered as(\n    SELECT *\n    FROM joined\n    WHERE date = (SELECT max_date FROM last_day)\n)\n\nSELECT\n    date,\n    symbol,\n    closing_data,\n    action,\n    value,\n    profit\nFROM\n    filtered", "relation_name": "\"postgres123_ahbr\".\"public\".\"dm_commodities\""}], "elapsed_time": 12.482330083847046, "args": {"require_explicit_package_overrides_for_builtin_materializations": true, "source_freshness_run_project_hooks": false, "partial_parse_file_diff": true, "quiet": false, "strict_mode": false, "defer": false, "macro_debugging": false, "log_level_file": "debug", "printer_width": 80, "profiles_dir": "../", "write_json": true, "enable_legacy_logger": false, "exclude": [], "select": [], "version_check": true, "invocation_command": "dbt run", "log_format": "default", "show_resource_report": false, "use_colors_file": true, "which": "run", "send_anonymous_usage_stats": true, "log_path": "C:\\Users\\vinic\\OneDrive\\Documentos\\python\\DataWarehouse_From_Screach\\postgres123_ahbr\\logs", "log_file_max_bytes": 10485760, "static_parser": true, "print": true, "project_dir": "C:\\Users\\vinic\\OneDrive\\Documentos\\python\\DataWarehouse_From_Screach\\postgres123_ahbr", "empty": false, "require_resource_names_without_spaces": false, "use_colors": true, "introspect": true, "log_format_file": "debug", "warn_error_options": {"include": [], "exclude": []}, "log_level": "info", "vars": {}, "indirect_selection": "eager", "populate_cache": true, "cache_selected_only": false, "partial_parse": true, "favor_state": false}}