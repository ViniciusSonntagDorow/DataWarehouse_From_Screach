{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.4", "generated_at": "2024-07-27T22:33:56.311386Z", "invocation_id": "be88ff92-cba3-46e4-8675-d34c12f10f92", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-27T22:33:56.290967Z", "completed_at": "2024-07-27T22:33:56.296401Z"}, {"name": "execute", "started_at": "2024-07-27T22:33:56.296401Z", "completed_at": "2024-07-27T22:33:56.296401Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006566762924194336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.postgres123_ahbr.stg_commodities", "compiled": true, "compiled_code": "-- source import\n\nwith source as (\n    SELECT\n        \"Date\",\n        \"Close\",\n        \"Symbol\"\n    FROM\n        \"postgres123_ahbr\".\"public\".\"commodities\"\n),\n\n-- renames/type changes/casts\n\nrenamed as (\n    SELECT\n        CAST(\"Date\" as date) as date,\n        \"Close\" as closing_data,\n        \"Symbol\" as symbol\n    FROM\n        source\n)\n\n-- select * from\n\nSELECT *\nFROM renamed", "relation_name": "\"postgres123_ahbr\".\"public\".\"stg_commodities\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-27T22:33:56.299402Z", "completed_at": "2024-07-27T22:33:56.301387Z"}, {"name": "execute", "started_at": "2024-07-27T22:33:56.302386Z", "completed_at": "2024-07-27T22:33:56.302386Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004984378814697266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.postgres123_ahbr.stg_movimentacao_commodities", "compiled": true, "compiled_code": "-- source import\n\nwith source as (\n    SELECT\n        date,\n        symbol,\n        action,\n        quantity\n    FROM\n        \"postgres123_ahbr\".\"public\".\"movimentacao_commodities\"\n),\n\n-- renames/type changes/casts\n\nrenamed as (\n    SELECT\n        CAST(date as date) as movement_date,\n        symbol,\n        action,\n        quantity\n    FROM\n        source\n)\n\n-- select * from\n\nSELECT *\nFROM renamed", "relation_name": "\"postgres123_ahbr\".\"public\".\"stg_movimentacao_commodities\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-27T22:33:56.304407Z", "completed_at": "2024-07-27T22:33:56.304407Z"}, {"name": "execute", "started_at": "2024-07-27T22:33:56.305402Z", "completed_at": "2024-07-27T22:33:56.305402Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001988649368286133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.postgres123_ahbr.movimentacao_commodities", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-27T22:33:56.306402Z", "completed_at": "2024-07-27T22:33:56.309401Z"}, {"name": "execute", "started_at": "2024-07-27T22:33:56.309401Z", "completed_at": "2024-07-27T22:33:56.309401Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0029993057250976562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.postgres123_ahbr.dm_commodities", "compiled": true, "compiled_code": "with commodities as (\n    SELECT\n        date,\n        closing_data,\n        symbol\n    FROM\n        \"postgres123_ahbr\".\"public\".\"stg_commodities\"\n),\n\nmovimentacao as (\n    SELECT\n        movement_date,\n        symbol,\n        action,\n        quantity\n    FROM\n        \"postgres123_ahbr\".\"public\".\"stg_movimentacao_commodities\"\n),\n\njoined as (\n    SELECT\n        c.date,\n        c.symbol,\n        c.closing_data,\n        m.action,\n        m.quantity,\n        (m.quantity * c.closing_data) as value,\n        CASE\n            WHEN m.action = 'sell' then (m.quantity * c.closing_data)\n            ELSE -(m.quantity * c.closing_data)\n        END as profit\n    FROM\n        commodities c\n    INNER JOIN\n        movimentacao m\n    ON\n        c.date = m.movement_date\n        AND\n        c.symbol = m.symbol\n),\n\nlast_day as (\n    SELECT max(date) as max_date\n    FROM joined\n),\n\nfiltered as(\n    SELECT *\n    FROM joined\n    WHERE date = (SELECT max_date FROM last_day)\n)\n\nSELECT\n    date,\n    symbol,\n    closing_data,\n    action,\n    value,\n    profit\nFROM\n    filtered", "relation_name": "\"postgres123_ahbr\".\"public\".\"dm_commodities\""}], "elapsed_time": 2.6484737396240234, "args": {"send_anonymous_usage_stats": true, "static": false, "defer": false, "cache_selected_only": false, "empty_catalog": false, "macro_debugging": false, "partial_parse_file_diff": true, "strict_mode": false, "invocation_command": "dbt docs generate", "indirect_selection": "eager", "static_parser": true, "enable_legacy_logger": false, "require_explicit_package_overrides_for_builtin_materializations": true, "use_colors": true, "print": true, "log_level": "info", "partial_parse": true, "quiet": false, "version_check": true, "warn_error_options": {"include": [], "exclude": []}, "vars": {}, "introspect": true, "log_path": "C:\\Users\\vinic\\OneDrive\\Documentos\\python\\DataWarehouse_From_Screach\\postgres123_ahbr\\logs", "populate_cache": true, "log_level_file": "debug", "printer_width": 80, "log_file_max_bytes": 10485760, "source_freshness_run_project_hooks": false, "show_resource_report": false, "log_format": "default", "exclude": [], "use_colors_file": true, "write_json": true, "project_dir": "C:\\Users\\vinic\\OneDrive\\Documentos\\python\\DataWarehouse_From_Screach\\postgres123_ahbr", "compile": true, "log_format_file": "debug", "require_resource_names_without_spaces": false, "favor_state": false, "select": [], "which": "generate", "profiles_dir": "../"}}