{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.4", "generated_at": "2024-07-27T22:26:07.561230Z", "invocation_id": "aad6721a-06bf-4e0c-b2c8-22552a704073", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-27T22:26:01.509937Z", "completed_at": "2024-07-27T22:26:01.514936Z"}, {"name": "execute", "started_at": "2024-07-27T22:26:01.515936Z", "completed_at": "2024-07-27T22:26:03.888523Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.379589319229126, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.postgres123_ahbr.stg_commodities", "compiled": true, "compiled_code": "-- source import\n\nwith source as (\n    SELECT\n        \"Date\",\n        \"Close\",\n        \"Symbol\"\n    FROM\n        \"postgres123_ahbr\".\"public\".\"commodities\"\n),\n\n-- renames/type changes/casts\n\nrenamed as (\n    SELECT\n        CAST(\"Date\" as date) as date,\n        \"Close\" as closing_data,\n        \"Symbol\" as symbol\n    FROM\n        source\n)\n\n-- select * from\n\nSELECT *\nFROM renamed", "relation_name": "\"postgres123_ahbr\".\"public\".\"stg_commodities\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-27T22:26:03.893505Z", "completed_at": "2024-07-27T22:26:03.896528Z"}, {"name": "execute", "started_at": "2024-07-27T22:26:03.896528Z", "completed_at": "2024-07-27T22:26:05.256501Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3639957904815674, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.postgres123_ahbr.stg_movimentacao_commodities", "compiled": true, "compiled_code": "-- source import\n\nwith source as (\n    SELECT\n        date,\n        symbol,\n        action,\n        quantity\n    FROM\n        \"postgres123_ahbr\".\"public\".\"movimentacao_commodities\"\n),\n\n-- renames/type changes/casts\n\nrenamed as (\n    SELECT\n        CAST(date as date) as movement_date,\n        symbol,\n        action,\n        quantity\n    FROM\n        source\n)\n\n-- select * from\n\nSELECT *\nFROM renamed", "relation_name": "\"postgres123_ahbr\".\"public\".\"stg_movimentacao_commodities\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-27T22:26:05.261502Z", "completed_at": "2024-07-27T22:26:05.264501Z"}, {"name": "execute", "started_at": "2024-07-27T22:26:05.264501Z", "completed_at": "2024-07-27T22:26:06.508862Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2493600845336914, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.postgres123_ahbr.dm_commodities", "compiled": true, "compiled_code": "with commodities as (\n    SELECT\n        date,\n        closing_data,\n        symbol\n    FROM\n        \"postgres123_ahbr\".\"public\".\"stg_commodities\"\n),\n\nmovimentacao as (\n    SELECT\n        movement_date,\n        symbol,\n        action,\n        quantity\n    FROM\n        \"postgres123_ahbr\".\"public\".\"stg_movimentacao_commodities\"\n),\n\njoined as (\n    SELECT\n        c.date,\n        c.symbol,\n        c.closing_data,\n        m.action,\n        m.quantity,\n        (m.quantity * c.closing_data) as value,\n        CASE\n            WHEN m.action = 'sell' then (m.quantity * c.closing_data)\n            ELSE -(m.quantity * c.closing_data)\n        END as profit\n    FROM\n        commodities c\n    INNER JOIN\n        movimentacao m\n    ON\n        c.date = m.movement_date\n        AND\n        c.symbol = m.symbol\n),\n\nlast_day as (\n    SELECT max(date) as max_date\n    FROM joined\n),\n\nfiltered as(\n    SELECT *\n    FROM joined\n    WHERE date = (SELECT max_date FROM last_day)\n)\n\nSELECT\n    date,\n    symbol,\n    closing_data,\n    action,\n    value,\n    profit\nFROM\n    filtered", "relation_name": "\"postgres123_ahbr\".\"public\".\"dm_commodities\""}], "elapsed_time": 11.580508470535278, "args": {"log_level": "info", "use_colors_file": true, "indirect_selection": "eager", "log_path": "C:\\Users\\vinic\\OneDrive\\Documentos\\python\\DataWarehouse_From_Screach\\postgres123_ahbr\\logs", "introspect": true, "invocation_command": "dbt run", "macro_debugging": false, "require_resource_names_without_spaces": false, "quiet": false, "static_parser": true, "use_colors": true, "strict_mode": false, "partial_parse_file_diff": true, "warn_error_options": {"include": [], "exclude": []}, "printer_width": 80, "partial_parse": true, "which": "run", "select": [], "log_level_file": "debug", "vars": {}, "defer": false, "print": true, "cache_selected_only": false, "profiles_dir": "../", "source_freshness_run_project_hooks": false, "require_explicit_package_overrides_for_builtin_materializations": true, "populate_cache": true, "log_format": "default", "log_file_max_bytes": 10485760, "project_dir": "C:\\Users\\vinic\\OneDrive\\Documentos\\python\\DataWarehouse_From_Screach\\postgres123_ahbr", "write_json": true, "favor_state": false, "empty": false, "show_resource_report": false, "version_check": true, "send_anonymous_usage_stats": true, "exclude": [], "log_format_file": "debug", "enable_legacy_logger": false}}